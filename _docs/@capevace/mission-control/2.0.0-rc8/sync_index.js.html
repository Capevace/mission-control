<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sync/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: sync/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * ### Sync – The heart of mission-control
 *
 * Sync is the main logic of mission control. It hosts the global event loop and
 * is responsible for managing state and synchronising it with connected clients.
 * The state can include like system information, HomeKit devices or anything 
 * plugins wish to make available to all clients.
 *
 * The event loop holds two types of event:
 *  - base-event
 * 	- request
 *
 * A base-event handles like any other event. 
 * It will be called but won't want any response back.
 * Event handlers will be called asynchronously and no error is thrown if an
 * event doesn't have a listener.
 *
 * A request is an event that will expect a response.
 * If no event handler can be found or an error occurs in one of them,
 * the response will be an error object which clients can handle accordingly.
 *
 * **Note**: the sync engine does NOT send request events to other clients.
 * These events get filtered out, so request information leaks.
 * However, all base-events are broadcasted to all connected clients.
 *
 * When the State is changed, a `state:updated` base-event is dispatched,
 * with the changed state inside.
 * **Note**: There currently is no validation in state updates to detect data corruption
 * for example by events arriving out of sync. So far this has not led to any problems,
 * but these could definitely occur if enough users or actions get executed silmutaneously.
 * This should be looked at in the future @todo.
 *
 * To change the state, a `setState` function is exposed which is a bit like React's.
 * It takes one argument, the updated state, and will run `Object.assign` to the current
 * state to only update changed values.
 * **Note**: Bear in mind, that this only works one level deep.
 *
 * So you'll still need to do this:
 * ```js
 * setState({
 * 		myPlugin: {
 * 			...myPlugin,
 * 			change: 'bla'
 * 		}
 * });
 * ```
 *
 * @example
 * state.subscribe('update:lights.desk')
 * state.subscribe('action:ACTION_NAME')
 * @example
 * function ACTION(oldState, actionData) {
 *     return Object.extend({}, oldState, { lampOn: actionData.isOn });
 * }
 * @module @state
 * @since 1.0.0
 * @requires eventemitter2
 * @requires object-diff
 * @requires @state/initial-state
 */

const EventEmitter = require('eventemitter2');
const diff = require('object-diff');

// const ActionEvent = require('@state/events/ActionEvent');

const logger = require('@helpers/logger').createLogger('State', 'blueBright');

const emitter = new EventEmitter({
	wildcard: true,
	delimiter: ':'
});

module.exports = {

};

const eventBus = require('eventemitter2');</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-@config.html">@config</a></li><li><a href="module-@database.html">@database</a></li><li><a href="module-@helpers_log.html">@helpers/log</a></li><li><a href="module-@http.html">@http</a></li><li><a href="module-@socket.html">@socket</a></li><li><a href="module-@state.html">@state</a></li><li><a href="module-@state_actions.html">@state/actions</a></li><li><a href="module-@state_initial-state.html">@state/initial-state</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-test.html">test</a></li></ul><h3>Global</h3><ul><li><a href="global.html#BAHN:UPDATE">BAHN:UPDATE</a></li><li><a href="global.html#comparePassword">comparePassword</a></li><li><a href="global.html#COVID:UPDATE">COVID:UPDATE</a></li><li><a href="global.html#hashPassword">hashPassword</a></li><li><a href="global.html#hashPasswordSync">hashPasswordSync</a></li><li><a href="global.html#HOMEKIT:SET-INITIALIZED">HOMEKIT:SET-INITIALIZED</a></li><li><a href="global.html#HOMEKIT:SET-SERVICES">HOMEKIT:SET-SERVICES</a></li><li><a href="global.html#LAYOUT:RESET">LAYOUT:RESET</a></li><li><a href="global.html#LAYOUT:UPDATE">LAYOUT:UPDATE</a></li><li><a href="global.html#NOTIFICATIONS:CREATE">NOTIFICATIONS:CREATE</a></li><li><a href="global.html#NOTIFICATIONS:DELETE">NOTIFICATIONS:DELETE</a></li><li><a href="global.html#NOTIFICATIONS:MARK-AS-READ">NOTIFICATIONS:MARK-AS-READ</a></li><li><a href="global.html#NOTIFICATIONS:SET">NOTIFICATIONS:SET</a></li><li><a href="global.html#PLUGINS:ADD">PLUGINS:ADD</a></li><li><a href="global.html#SPOTIFY:UPDATE-TOKEN">SPOTIFY:UPDATE-TOKEN</a></li><li><a href="global.html#SYSTEM-INFO:UPDATE">SYSTEM-INFO:UPDATE</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sat Apr 24 2021 01:53:25 GMT+0200 (Mitteleuropäische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
